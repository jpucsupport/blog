---
title: EXE 版の Teams のインストーラーの変更によるインストールへの影響について
date: 2022-03-31 00:00:00
tags:
  - Teams
  - Install
---

# EXE 版の Teams のインストーラーの変更によるインストールへの影響について

こんにちは。Unified Communications サポート チームです。  
いつも Microsoft Teams をご利用いただきありがとうございます。  
<br />
ここ直近（2022 年 3 月 31 日時点）になり EXE 版の Teams のインストーラーが新しい実装に変更され、その結果、以前のインストーラーとの違いにより、インストールがうまく行かなくなる事例が発生しております。  
現在、本件について、事前にご案内されている公開情報がないため、皆様にはご迷惑をおかけしており、誠に申し訳ございません。  
上記日付時点までで確認が出来ている問題点、対処方法などについて、本 Blog にてご紹介をさせていただきます。  
<br />

## 確認が出来ている問題点について
確認できている問題として、大きく以下の 3 点がございます。  
① teams.live.com へのアクセスができない場合（環境）に、インストールに失敗する  
② Applocker などで制御をしている場合、ルールによってインストールの実行が妨げられる    
③ .Net Framework 4.7.1 以降がインストールされていない環境では、新しいインストーラーの実行に失敗する  
<br />

## 発生する影響への技術的説明について
それぞれについての技術的説明を以下に記載します。  

### ① teams.live.com へのアクセスができない場合に、インストールに失敗する
新しいインストーラーでは以前とは異なり、インストーラーを実行した際に、そのタイミングにおける最新のバージョンの確認と最新のバージョンのモジュールのダウンロードを同時に行います。  
この実行時の最新のバージョンの確認に際し、teams.live.com へのアクセスを行いますため、ご利用の環境における通信にて、teams.live.com へのアクセスができない場合はインストールに失敗することになります。  
<br />

### ② Applocker などで制御をしている場合、ルールによってインストールの実行が妨げられる  
インストーラーの変更に伴い、製品名などの情報が変更になっております。Applocker で製品名も含めて条件ルールを作成している場合は、製品名が変更になったことで、実行の条件を満たすことができず、実行ができないため、結果としてインストールに失敗します。  
<br />

### ③ .Net Framework 4.7.1 以降がインストールされていない環境では、新しいインストーラーの実行に失敗する
新しいインストーラーでは、.Net Framework 4.7.1 以降のバージョンが必要となっております。そのため、.Net Framework 4.7.1 以降がインストールされていない場合には、インストールに失敗することになります。  
<br />

## 対処策について
以下にそれぞれについての対処策を記載します。

### ① teams.live.com へのアクセスができない場合に、インストールに失敗する
Firewall や Proxy Server などで teams.live.com を FQDN としているドメインへの接続を許可するようにしてください。  
なお、teams.live.com へのアクセスできるようにしていただいても改善しない場合は、必要な一連のモジュール群のダウンロードでアクセスする statics.teams.cdn.office.net へのアクセスができていない可能性がございます。teams.live.com へのアクセス許可でインストールができない場合は、statics.teams.cdn.office.net へのアクセスも許可していただき、インストールができるようになるかをご確認くださいますようお願いいたします。  
<br />

### ② Applocker などで制御をしている場合、ルールによってインストールの実行が妨げられる  
Applocker のルールにて、Product Name を許可している場合は、Product Name として Squirrel-based application を追加してください。  
<br />

### ③ .Net Framework 4.7.1 以降がインストールされていない環境では、新しいインストーラーの実行に失敗する
Windows 8.1 環境など、.Net Framework 4.7.1 以降がインストールされていない環境に対しては、Teams のインストールを行う前に .Net Framework 4.7.1 以降のバージョンをインストールしてください。 
なお、.Net Framework 4.7.1 以降はサポートされている SAC 版の Windows 10 では標準として導入されております。   
<br />

インストーラーの変更によりインストールができない問題が発生した際には、上述の対応などにてインストールできるようになるのかをご確認いただけますと幸いです。
<br />

NOTE:
+ 2022 年 3 月 31 日に、初版を公開しました。
+ 2022 年 3 月 31 日に、③ に関する内容を追加しました。