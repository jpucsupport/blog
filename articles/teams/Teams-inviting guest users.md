---
title: Teams - ゲスト ユーザーを招待した際の動作
date: 2021-7-5 15:00:00
tags:
  - Microsoft Teams 
  - Guest User 
---

# Teams - ゲスト ユーザーを招待した際の動作

こんにちは。Unified Communications サポート チームの吉井です。いつも Microsoft Teams をご利用いただきありがとうございます。 

今回は、Teams で自社テナントにゲスト ユーザーを招待したときの一般的な流れについてご紹介します。
ゲスト ユーザーとなると、自テナントのみでの検証が難しく、実際にお客様をゲスト ユーザーとして招待したけど、どういった案内がゲスト ユーザーに送付されているのか、どういった流れでゲスト ユーザーとしてテナントに参加するのか、などイメージがつきにくい部分も多く、お問い合わせが多い内容となっております。
また、お客様の運用によってゲスト ユーザーの招待の運用方法が異なりますので、招待方法別にそれぞれ詳細をご案内いたします。

> 凡例 : 
> テナント A : 招待元テナント（自社テナント）
> テナント B : ゲスト ユーザーが所属するテナント


### A-1. ゲスト ユーザーを Teams (クライアントや Web) から招待した際の流れ (招待側 : テナント A)
Teams (クライアントや Web) 経由でゲスト ユーザーを招待する場合には、以下の手順で招待することが可能です。
※ 手順は一例となります。以下の手順以外でもメンバーの追加は可能ですので、あくまでも Teams クライアントや Web からの追加を行った場合の流れとなります。

テナント A での招待の手順が完了すると、テナント B のゲスト ユーザーに招待通知メールが送付されるので、ゲスト ユーザー側での操作が完了するのをお待ちください。

> 1. テナント A 内のゲスト ユーザーを招待したいチーム名の右にある [...] を選択し、[メンバーを追加] をクリックします。
> 1. 招待したいユーザーのメールアドレスを入力します。
> 1. [(入力したメールアドレス）をゲストとして追加] を選択し、[追加] ボタンをクリックします。


### A-2. テナント A からゲスト ユーザーとして招待された際の流れ (ゲストユーザー側 : テナント B)
テナント A でゲスト ユーザーの招待の手順が完了すると、招待されたユーザーに対して、以下のような通知メールが送付されます。
![](./A2通知メール.png)

通知メール内の [Open Microsoft Teams] をクリックすると、ゲスト ユーザーとしてテナント A に参加する処理が進みます。

テナント B が組織テナントの場合には、テナント B に登録しているユーザー名とパスワードでサインインすると、アクセス許可を求める画面が表示されます。
こちらは、テナント A がテナント B からゲスト ユーザーの基本情報を取得するための許可になります。
内容を確認のうえ、[承諾] をクリックすると、テナント A にゲスト ユーザーとして参加が可能になります。
![](./A2アクセス許可.png)

また、ゲスト ユーザーが組織テナントに所属していない場合（例 : Gmail を利用しているユーザーなど）には、任意のパスワードを入力してサインインを進めてください。
※ 今後のサインイン時に必要なパスワードとなります。

アクセス許可を求める画面からのフローは組織テナントに所属しているユーザーと同様です。


### B-1. Azure AD からゲスト ユーザーを招待した際の流れ (招待側 : テナント A)
Azure AD 管理ポータルからゲスト ユーザーを招待する場合には、、以下の手順で招待することが可能です。
Azure AD 管理ポータル側での招待の手順が完了すると、テナント B のゲスト ユーザーに招待通知メールが送付されるので、ゲスト ユーザーでの操作が完了するのをお待ちください。

> 1. テナント A の Azure AD 管理ポータルにアクセスします。
> 1. [ユーザー] 一覧ページから、[+ 新しいゲスト ユーザー] をクリックします。
> 1. 必要情報を入力し、[招待] をクリックします。


### B-2. Azure AD からゲストユーザーを招待した際の流れ (ゲスト ユーザー側 : テナント B)
テナント A でゲスト ユーザーの招待の手順が完了すると、招待されたユーザーに対して、以下のような通知メールが送付されます
![](./B2通知メール.png)

通知メール内の [Accept invitation] をクリックすると、ゲスト ユーザーとしてテナント A に参加する処理が進みます。
サインイン/認証のフローは、A-2 で記載した内容と同様です。
ゲスト ユーザーとしてテナント A への参加が完了すると、以下のページが表示されます。
![](./TB2マイアプリ.png)

Teams のチームにゲスト ユーザーを追加する場合には、既にテナント A の Azure AD にゲスト ユーザーとして登録されている状況なので、通常の Teams のチームへのユーザーの追加と同様の手順でチームに追加してください。

また、Azure AD からゲスト ユーザーを追加する場合、招待するグループを指定することができます。
その場合には、[グループとロール] 項目で追加するグループを指定してください。
ゲスト ユーザー側での参加のフローは変わりませんが、Teams のチームに追加された場合に送付される通知メールが送付されないので、ゲスト ユーザー自身で Microsoft Teams にアクセスして、参加チームを確認する必要があります。


### C. システム上の流れ
テナント A, B のアカウントはそれぞれ別のアカウントであり、ゲスト ユーザーが A-2, B-2 の手順において、ユーザー情報の読み取りを承諾したタイミング以外では、テナント A / B 間の情報の連携は行われません。
具体的な流れは以下になります。

--------------
例:
テナント B (@fabrikam.com) に所属するユーザー "MS太郎" (UPN: userX@fabrikam.com) が、テナント A (@contoso.com) にゲスト参加する場合の流れについて

1. テナント A にて、テナント B に所属するユーザーである "MS太郎" をゲスト ユーザーとして招待します。(A-1, B-1)
このタイミングでテナント A 側の Azure AD 上に、ユーザー X 用のゲスト アカウントが新規にて作成されます。
    // テナント B 上
    - 表示名: MS太郎
    - UPN: userX@fabrikam.com (一般アカウント)

    // テナント A 上
    - 表示名: userX ※既定ではメールアドレスの先頭部分がユーザー名となります
    - UPN: userX_fabrikam.com#EXT#@contoso.com (ゲスト アカウント)

2. "MS太郎" が、テナント A へゲスト参加する際、ユーザー情報の読み取りを承諾します。(A-2,B-2)
このタイミングでテナント B の Azure AD 上に登録されている表示名が、テナント A 上のゲスト アカウントの表示名に反映されます。
※ 当該タイミング以外での情報の連携は行われません

    // テナント B 上
    - 表示名: MS太郎
    - UPN: userX@fabrikam.com (一般アカウント)

    // テナント A 上
    - 表示名: MS太郎
    - UPN: userX_fabrikam.com#EXT#@contoso.com (ゲスト アカウント)
--------------


### D. ゲスト ユーザー側でテナントの切り替えができない場合の一般的な対処方法
正常にゲスト ユーザーの招待が完了しているにもかかわらず、ゲスト ユーザー側でテナントの切り替えができない問題が起こることがあります。
この場合には、クライアントのキャッシュなどの影響で反映が遅くなっている可能性があるため、ゲスト ユーザー側でキャッシュクリアをお試しいただき、事象が解消するかご確認ください。

> ・Microsoft Teams のクライアントアプリのキャッシュ削除の方法
> 1. Microsoft Teams を終了します。
> 2. Windows キーを押したまま、[R] キーを押します。
> 3. [ファイル名を指定して実行] のダイアログに、[名前] に "%AppData%\Microsoft" を入力し、[OK] をクリックします。
> 4. [Teams] フォルダーを削除します。 ※ 削除できない場合は、Microsoft Teams が起動している可能性がございます。
> 5. Microsoft Teams を起動し、事象が改善されるかを確認します。

キャッシュクリアを試しても事象が解消しない場合や、それ以外の事象の場合には、一度テナント A の Azure AD からゲスト ユーザーを削除して再度招待することで問題が解決する場合もあります。

### E. 注意事項
#### ゲスト ユーザーの情報が変更された場合
テナント A が、テナント B からゲスト ユーザーの情報を取得するタイミングは、ゲスト ユーザー側でアクセス許可を承諾したタイミングのみとなります。
そのため、テナント B にてユーザーの情報（UPN や Display Name）が変更された場合には、再度テナント A でゲスト ユーザーを再招待または修正作業を行う必要があります。
特に UPN が変更された場合には、ゲスト ユーザーがテナント A にゲスト ユーザーとしてサインインできなくなりますので、情報変更前の対応を推奨しております。


#### ゲスト ユーザーのメールアドレスの有無について
テナント A に、メール連絡先などで既に テナント B のゲスト ユーザーのメールアドレスが登録されている場合には、ゲスト ユーザーのアカウントのメールアドレスの情報が null となった状態で、テナントに登録されます。
しかしながら、Microsoft Teams では、ゲスト ユーザーのメールアドレスが必須となっているため、メールアドレスの情報がない状態のゲスト ユーザーはサポートされません。
そのため、ゲスト ユーザーのメール連絡先がすでに存在する場合には、ゲスト ユーザー招待前にメール連絡先を削除する必要があります。


### F. 参考情報
Title : Teams でのゲスト エクスペリエンス
URL : https://docs.microsoft.com/ja-jp/microsoftteams/guest-experience

Title : Microsoft Teams でのゲスト アクセス
URL : https://docs.microsoft.com/ja-jp/microsoftteams/guest-access

Title : ゲスト アクセスと外部アクセスを使用して、組織外の人々とコラボレーションする
URL : https://docs.microsoft.com/ja-jp/microsoftteams/communicate-with-users-from-other-organizations